<!DOCTYPE html>
<html data-ng-app="roadWarrior" lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no, width=device-width">
    <title>Road Warrior</title>
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:400,700" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="css/styles.css">
  </head>

  <body>

    <div class="logo"> <img src="images/logo-transparent-35px.png" alt="Road warrior logo" /></div>   
    <div id="map-canvas"></div>
    <div id="elevation-wrapper" class="hideChart">
      <div id="nested-elevation-wrapper">
        <div id="elevation-chart"></div>  
      </div>
      <div id="slider-button"></div>
    </div> 
    
    <div id="sideMenu" class="hideMenu" data-ng-controller="SideBarController as SideBar">  
      <div class="tabList">
        <div class="tab" id="trekListTab" aria-controls="trekList" data-ng-click="SideBar.tabSwitcher('trekList')">
          <div>my treks</div>
        </div>
        <div class="tab current" id="currentTrekTab" aria-controls="trekDetails" data-ng-click="SideBar.tabSwitcher('currentTrek')">
          <div>current trek</div>
        </div>
        <div class="tab" id="directionsTab" aria-controls="directions" data-ng-click="SideBar.tabSwitcher('directions')">
          <div>directions</div>
        </div>
        <div class="tab" id="accountTab" aria-controls="account" data-ng-click="SideBar.tabSwitcher('account')">
          <div>account</div>
        </div>
      </div>

      <div id="sidebarContent" class="currentTrek" data-ng-controller="TrekController as Trek" role="navigation">  
        <div class="panel" data-ng-show="SideBar.activePanel(0)">
          <div class="sidebarSection" id="trekDetails" data-ng-cloak>

            <div class="trekTitle">
              <span data-ng-click="Trek.editName()" data-ng-hide="Trek.showEditName" class="slideLink">{{Trek.name}}</span>
              <span style="float:right">
                <span class="slideLink noHint" data-ng-click="Trek.saveTrek()" style="float:left">save trek</span>&nbsp;|&nbsp;
                <span class="slideLink noHint" data-ng-click="Trek.clearTrek()" style="float:right">clear trek</span>
              </span>
        
              <form data-ng-show="Trek.showEditName">
                <input type="text" data-ng-model="Trek.name" data-ng-blur="Trek.editName()" placeholder="Name your trek"/>
              </form>
            </div>

            <div id="legList">
              <div data-ng-repeat="leg in Trek.legs track by $index" class="leg" data-ng-class-odd="'odd'">
                <span data-ng-click="Trek.toggleDetails($index)">
                  <span class="slideLink">
                    <span class="bold">{{leg.origin.index}}</span>
                    {{Trek.markerName(leg.origin)}} => 
                    <span class="bold">{{leg.dest.index}}</span>
                    {{Trek.markerName(leg.dest)}}
                  </span>
                </span>
                <span style="float:right; padding-right: 5px;" class="slideLink noHint" data-ng-click="Trek.removeLeg($index)"><b>delete</b></span>

                <div data-ng-show="Trek.showDetails[$index]" class="legOptions">
                  <form data-ng-submit="Trek.toggleDetails($index)">
                    <div><label>origin name: </label><input type="text" data-ng-model="leg.origin.name" /></div>
                    <div><label>destination name: </label><input type="text" data-ng-model="leg.dest.name" /></div>
                    travel mode: 
                    <select data-ng-model="leg.travelMode" data-ng-change="leg.getDirections()">
                      <option value="WALKING">Walking</option>
                      <option value="DRIVING">Driving</option>
                      <option value="BICYCLING">Bicycling</option>
                      <option value="TRANSIT">Transit</option>
                    </select>
                    <input type="submit" data-ng-hide="true"/>
                  </form>
                  <div>Net Elevation Gain: {{ leg.dest.elevation - leg.origin.elevation | metersToFeet }} feet</div>
                  <div>Distance: {{ leg.rend.directions.routes[0].legs[0].distance.value |  metersToMiles }} miles</div>
                </div>
              </div>
            </div> 
          </div>
          <div class="bold totalDistance" data-ng-cloak>total distance: {{ Trek.legs|totalDistance | metersToMiles }} miles</div>
        </div>

        <div class="panel" data-ng-show="SideBar.activePanel(1)">
          <div class="sidebarSection" id="trekList">

            <div class="myTreks bold">My Treks&nbsp;&nbsp;&nbsp;
              <input type="search" style="font-weight:normal" data-ng-model="search.name" placeholder="Search your treks" />
            </div>

            <div class="trekList trek" data-ng-repeat="trek in Trek.treks | filter:search" data-ng-cloak>
              <span class="slideLink retrieve" data-ng-click="Trek.renderTrek(trek)">{{trek.name}}</span>
              <span class="slideLink noHint" data-ng-click="Trek.deleteTrek(trek)" style="float:right">delete trek</span>
            </div>

          </div>
        </div>

        <div class="panel" data-ng-show="SideBar.activePanel(2)">
          <div class="sidebarSection" id="directions" style="border:1px solid red">
            <div data-ng-repeat="leg in Trek.legs track by $index" id="{{'leg' + $index}}">
            </div>
          </div>
        </div>
        <div class="panel" data-ng-show="SideBar.activePanel(3)" data-ng-controller="UserController as User">
          <div class="sidebarSection" id="account">
            <div class="logIn" data-ng-show="SideBar.showLogIn()">
              <form class="user-forms" data-ng-submit="User.logIn()">
                <input type="text" placeholder="User Name" data-ng-model="User.username" />
                <input type="password" placeholder="Password" data-ng-model="User.password" />
                <button>Log in</button>
              </form>
              <span>Don't have an account yet? Then <span class="slideLink" data-ng-click="SideBar.toggleAccountActions()">
              <span class="bold">sign up</span></span>.</span> 
            </div>
            <div class="createAccount" data-ng-show="SideBar.showCreateAccount()"> 
              <form name="createAccountForm" class="user-forms" novalidate data-ng-submit="User.createAccount()">
                <input required type="text" name="username" placeholder="User Name" data-ng-blur="User.checkUsername()" data-ng-model="User.username"/>
                <span class="errMsg" ng-show="User.dupeUsername">User name is already in use.</span>
                <span class="errMsg" ng-show="createAccountForm.username.$error.required">User name is required.</span>
                <input required type="password" placeholder="Enter password" name="password" data-ng-model="User.password" />
                <span class="errMsg" ng-show="createAccountForm.password.$error.required">Password is required.</span>     
                <input required type="password" placeholder="Re-enter password" name="verify" data-ng-model="User.verify" data-ng-blur="User.verifyPassword()"/>
                <span class="errMsg" ng-show="createAccountForm.verify.$error.required">Verify password is required.</span>
                <span class="errMsg" ng-show="User.verifyPasswordFail">Passwords must match.</span>
                <button>Sign up</button>
              </form>
              <span>Already have an account? Then <span class="slideLink" data-ng-click="SideBar.toggleAccountActions()">
              <span class="bold">log in</span></span>.</span>
            </div> 
            <div class="accountInfo" data-ng-show="User.accountInfo()">
              User NAME!
              User STUFF!
              Password CHANGE!
              PICS, BRAH!
              <button ng-click="Trek.signOut(); User.signOut(); createAccountForm.username.$setUntouched(); createAccountForm.password.$setUntouched(); createAccountForm.verify.$setUntouched()">Sign out</button> 
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.min.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?v=3&amp;key=AIzaSyDBh5D3dvdcbDztl4PrNX97zF_6oQe203s"></script>   
    <script src="https://www.google.com/jsapi"></script>
    <script type="text/javascript" src="https://www.google.com/jsapi?autoload={'modules':[{'name':'visualization','version':'1','packages':['corechart']}]}"></script>
    <script src="js/main.js"></script>
  </body>
</html>
